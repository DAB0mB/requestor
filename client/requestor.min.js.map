{"version":3,"file":"generated.js","sources":["../../../../usr/local/lib/node_modules/browserify/node_modules/browser-pack/_prelude.js","lib/collection-requestor.js","lib/index.js","lib/model-requestor.js","lib/requestor.js","lib/utils.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","Requestor","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"Utils","CollectionRequestor","dependencyIds","ids","inherit","apply","arguments","dependency","models","map","id","model","buildModel","urlRoot","url","prototype","Object","create","constructor","docsNum","attrs","that","promises","array","server","push","Promise","all","then","results","resolve","destroy","forEach","_defaultRequests","fetchAll","fetch","update","_getRequestsManifest","rawModelRequests","requests","modelRequests","keys","reduce","action","path","weld","_createRequest","method","suburl","data","_createRequestPromise","_composeUrl","navchar","replace","name","proto","ModelRequestor","Model","Collection","baseDependencyIds","slice","baseId","pop","base","entity","idAttr","save","onCreateRequest","result","onDestroyRequest","Boom","Request","_initRequests","pathSplit","split","capitalize","onInject","identity","bind","parseData","reject","response","_createResponse","request","err","requestHandler","_clientRequest","dummy","_serverRequest","callback","$","ajax","dataType","success","error","xhr","responseText","qs","body","config","json","statusCode","defineRequestMethod","EntityRequestor","NewRequestor","nameFn","newProto","extend","Array","toArray","obj","str","substr","toUpperCase","objs","concat","extensions","extension","k","v","fn","eval"],"mappings":"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AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var Requestor = require(\"./requestor\");\nvar Utils = require(\"./utils\");\n\nfunction CollectionRequestor() {\n  var dependencyIds, ids;\n\n  if (!(this instanceof CollectionRequestor))\n    return CollectionRequestor.inherit.apply(CollectionRequestor, arguments);\n\n  if (this.dependency) {\n    dependencyIds = arguments[0];\n    ids = arguments[1];    \n  }\n  else {\n    ids = arguments[0];\n  }\n\n  this.models = ids.map(function(id) {\n    id = id instanceof Requestor ? id.id : id;\n    return new this.model(dependencyIds, id);\n  }, this);\n\n  var buildModel = new this.model(dependencyIds);\n  this.urlRoot = buildModel.urlRoot;\n  this.url = buildModel.url;\n}\n\nCollectionRequestor.prototype = Object.create(Requestor.prototype);\nCollectionRequestor.prototype.constructor = CollectionRequestor;\n\nCollectionRequestor.prototype.create = function(docsNum, attrs) {\n  var that = this;\n  var models = [];\n\n  var promises = Utils.array(docsNum).map(function(i) {\n    var model = new this.model(this.server, this.dependencyIds);\n    models.push(model);\n    return model.create(attrs);\n  }, this);\n\n  return Promise.all(promises).then(function(results) {\n    that.models = models;\n    return Promise.resolve(results);\n  });\n};\n\nCollectionRequestor.prototype.destroy = function() {\n  var that = this;\n\n  var promises = this.models.forEach(function(model) {\n    return model.destroy();\n  });\n\n  return Promise.all(promises).then(function(results) {\n    delete that.models;\n    return Promise.resolve(results);\n  });\n};\n\nCollectionRequestor.prototype._defaultRequests = {\n  fetchAll: \"GET .  \",\n  fetch:    \"GET */.\",\n  update:   \"PUT */.\"\n};\n\nCollectionRequestor.prototype._getRequestsManifest = function() {\n  var rawModelRequests = this.model.prototype.requests;\n\n  var modelRequests = Object.keys(rawModelRequests).reduce(function(modelRequests, action) {\n    var path = rawModelRequests[action];\n    modelRequests[action] = \"*/\" + path;\n    return modelRequests;\n  }, {});\n\n  return Utils.weld(\n    modelRequests,\n    this._defaultRequests,\n    this.requests\n  );\n};\n\nCollectionRequestor.prototype._createRequest = function(action, method, suburl) {\n  return function(data) {\n    if (suburl[0] != \"*\")\n      return this._createRequestPromise(action, method, suburl, data);\n\n    var promises = this.models.map(function(model) {\n      return model[action](data);\n    });\n\n    return Promise.all(promises);\n  };\n};\n\nCollectionRequestor.prototype._composeUrl = function(suburl, navchar) {\n  switch (navchar) {\n    case \"~\": return suburl.replace(navchar, this.urlRoot);\n    case \".\": return suburl.replace(navchar, this.url);\n  }\n};\n\nCollectionRequestor.inherit = function(name, proto) {\n  return Requestor.inherit(CollectionRequestor, name, proto);\n};\n\nmodule.exports = CollectionRequestor;","var Requestor = require(\"./requestor\");\nvar ModelRequestor = require(\"./model-requestor\");\nvar CollectionRequestor = require(\"./collection-requestor\");\n\nRequestor.Model = ModelRequestor;\nRequestor.Collection = CollectionRequestor;\n\nmodule.exports = Requestor;","var Requestor = require(\"./requestor\");\nvar Utils = require(\"./utils\");\n\nfunction ModelRequestor() {\n  var dependencyIds, id;\n\n  if (!(this instanceof ModelRequestor))\n    return ModelRequestor.inherit.apply(ModelRequestor, arguments);\n\n  if (this.dependency || arguments.length == 2) {\n    dependencyIds = arguments[0];\n    id = arguments[1];\n  }\n  else {\n    id = arguments[0];\n  }\n\n  this.id = id;\n  \n  if (dependencyIds && dependencyIds.length) {\n    var baseDependencyIds = dependencyIds.slice();\n    var baseId = baseDependencyIds.pop();\n    var base = new this.dependency(baseDependencyIds);\n    this.urlRoot = base.url + \"/\" + baseId;\n  }\n\n  this.url = this.urlRoot + \"/\" + this.entity;\n}\n\nModelRequestor.prototype = Object.create(Requestor.prototype);\nModelRequestor.prototype.constructor = ModelRequestor;\nModelRequestor.prototype.idAttr = \"_id\";\n\nModelRequestor.prototype.save = function(attrs) {\n  if (this.id)\n    this.update(attrs);\n  else\n    this.create(attrs);\n};\n\nModelRequestor.prototype.onCreateRequest = function(result) {\n  this.id = result[this.idAttr];\n};\n\nModelRequestor.prototype.onDestroyRequest = function() {\n  delete this.id;\n};\n\nModelRequestor.prototype._defaultRequests = {\n  create:  \"POST   ..\",\n  fetch:   \"GET    . \",\n  update:  \"PUT    . \",\n  destroy: \"DELETE . \"\n};\n\nModelRequestor.prototype._getRequestsManifest = function() {\n  return Utils.weld(this._defaultRequests, this.requests);\n};\n\nModelRequestor.prototype._createRequest = function(action, method, suburl) {\n  return function(data) {\n    return this._createRequestPromise(action, method, suburl, data);\n  };\n};\n\nModelRequestor.prototype._composeUrl = function(suburl, navchar) {\n  switch (navchar) {\n    case \"~\": return suburl.replace(navchar, this.urlRoot);\n    case \"..\": return suburl.replace(navchar, this.url);\n    case \".\": return suburl.replace(navchar, this.url + \"/\" + this.id);\n  }\n};\n\nModelRequestor.inherit = function(name, proto) {\n  return Requestor.inherit(ModelRequestor, name, proto);\n};\n\nmodule.exports = ModelRequestor;","var Boom = (typeof window !== \"undefined\" ? window['Boom'] : typeof global !== \"undefined\" ? global['Boom'] : null);\nvar Promise = (typeof window !== \"undefined\" ? window['Promise'] : typeof global !== \"undefined\" ? global['Promise'] : null);\nvar Request = (typeof window !== \"undefined\" ? window['Request'] : typeof global !== \"undefined\" ? global['Request'] : null);\nvar Utils = require(\"./utils\");\n\nfunction Requestor(dependencyIds) {}\n\nRequestor.prototype._initRequests = function(requests) {\n  Object.keys(requests).forEach(function(action) {\n    var path = requests[action];\n    var pathSplit = path.split(/\\s+/);\n    var method = pathSplit[0];\n    var suburl = pathSplit[1];\n    this[action] = this[action] || this._createRequest(action, method, suburl);\n  }, this);\n};\n\nRequestor.prototype._createRequestPromise = function(action, method, suburl, data) {\n  var that = this;\n  var navchar = suburl.split(\"/\")[0];\n  var name = Utils.capitalize(action);\n  var onInject = (this[\"on\" + name + \"Request\"] || Utils.identity()).bind(this);\n  var parseData = (this[\"parse\" + name + \"Data\"] || Utils.identity()).bind(this);\n  data = parseData(data);\n\n  return new Promise(function(resolve, reject) {\n    var url = that._composeUrl(suburl, navchar);\n    var response = that._createResponse(resolve, reject, onInject);\n    that.request(method, url, data, response);\n  });\n};\n\nRequestor.prototype._createResponse = function(resolve, reject, onInject) {\n  return function(err, result) {\n    if (err) return reject(err);\n    onInject(result);\n    resolve(result);\n  };\n};\n\nRequestor.prototype.request = function() {\n  var requestHandler;\n\n  try {\n    requestHandler = window && this._clientRequest;\n  }\n  catch (dummy) {\n    requestHandler = this._serverRequest;\n  }\n\n  requestHandler.apply(this, arguments);\n};\n\nRequestor.prototype._clientRequest = function(method, url, data, callback) {\n  $.ajax({\n    method: method,\n    url: url,\n    data: data,\n    dataType: \"json\",\n    success: function(result) {\n      callback(null, result);\n    },\n    error: function(xhr) {\n      var err = Error(xhr.responseText);\n      callback(err);\n    }\n  });\n};\n\nRequestor.prototype._serverRequest = function(method, url, data, callback) {\n  var qs, body;\n\n  if (method == \"get\")\n    qs = data;\n  else\n    body = data;\n\n  var config = {\n    method: method,\n    url: url,\n    qs: qs,\n    body: body,\n    json: true\n  };\n\n  Request(config, function(err, response, body) {\n    if (err) return callback(err);\n    var statusCode = response.statusCode;\n\n    if (statusCode != 200)\n      err = Boom.create(statusCode);\n\n    callback(err, body);\n  });\n};\n\nRequestor.defineRequestMethod = function(method) {\n  Requestor.prototype.request = method;\n};\n\nRequestor.inherit = function(EntityRequestor, name, proto) {\n  var NewRequestor = Utils.nameFn(name, function() {\n    EntityRequestor.apply(this, arguments);\n  });\n\n  var newProto = Object.create(EntityRequestor.prototype);\n  NewRequestor.prototype = newProto;\n  Utils.extend(newProto, proto);\n\n  newProto.constructor = NewRequestor;\n  newProto.requests = newProto.requests || {};\n\n  var requests = newProto._getRequestsManifest();\n  newProto._initRequests(requests);\n\n  return NewRequestor;\n};\n\nmodule.exports = Requestor;","var array = function(length) {\n  return Array.apply(null, {length: length});\n};\n\nvar toArray = function(obj) {\n  return [].slice.call(obj);\n};\n\nvar capitalize = function(str) {\n  return str.substr(0, 1).toUpperCase() + str.substr(1);\n};\n\nvar identity = function(result) {\n  return function() {\n    return result;\n  };\n};\n\nvar weld = function() {\n  var objs = [{}].concat(toArray(arguments));\n  return extend.apply(null, objs);\n};\n\nvar extend = function(obj) {\n  var extensions = toArray(arguments).slice(1);\n\n  extensions.forEach(function(extension) {\n    Object.keys(extension).forEach(function(k) {\n      var v = extension[k];\n      obj[k] = v;\n    });\n  });\n\n  return obj;\n};\n\nvar nameFn = function(name, fn) {\n  return eval('(function ' + name + '() {return fn.apply(this, arguments);})');\n};\n\nmodule.exports = {\n  array: array,\n  toArray: toArray,\n  capitalize: capitalize,\n  identity: identity,\n  weld: weld,\n  extend: extend,\n  nameFn: nameFn\n};"]}